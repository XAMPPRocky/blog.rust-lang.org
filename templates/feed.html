<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>{{ page.title }}</title>
        <link>{{ config.base_url | escape_xml | safe }}</link>
        <description>{{ page.description }}</description>
        <generator>Zola</generator>
        <language>{{ config.default_language }}</language>
        {%- set prefix = page.extra.prefix | default(value="") -%}
        {%- for path in page.ancestors -%}
        {%- if prefix in path -%}
            {%- set_global section = get_section(path=path) -%}
        {%- else %}
        {%- endif %}
        {%- endfor %}
        <atom:link href="{{ config.base_url ~ "/" ~ prefix ~ "feed.xml" | safe }}" rel="self" type="application/rss+xml"/>
        <lastBuildDate>{{ now() | date(format="%a, %d %b %Y %H:%M:%S %z") }}</lastBuildDate>
        {%- for post in section.pages -%}
        {%- if post.extra.is_feed is not defined -%}
        <item>
            <title>{{ post.title }}</title>
            <pubDate>{{ post.date | date(format="%a, %d %b %Y %H:%M:%S %z") }}</pubDate>
            <link>{{ post.permalink | escape_xml | safe }}</link>
            <guid>{{ post.permalink | escape_xml | safe }}</guid>
            <description>{% if post.summary %}{{ post.summary }}{% else %}{{ post.content }}{% endif %}</description>
        </item>
        {%- endif -%}
        {%- endfor %}
    </channel>
</rss>
